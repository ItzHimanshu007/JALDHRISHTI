<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jal Drishti - Mission Control</title>
    <!-- MapLibre -->
    <script src='https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js'></script>
    <link href='https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css' rel='stylesheet' />
    <!-- Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Bench/Font -->
    <link
        href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Inter:wght@300;400;600&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css?v=3.0">
</head>

<body>
    <!-- 1. The Map (Background) -->
    <div id="map"></div>

    <!-- 2. Floating HUD Interface -->
    <div class="hud-container">

        <!-- Header -->
        <div class="hud-header pointer-events-auto">
            <div class="brand">
                <span class="brand-icon">üåä</span>
                <span class="brand-text">Jal Drishti</span>
                <span class="brand-tag">v2.4</span>
            </div>
            <div class="nav-links" id="main-nav-links">
                <a href="user-guide.html" class="nav-link" id="link-user-guide">User Guide</a>
                <a href="methodology.html" class="nav-link" id="link-methodology">Methodology</a>
            </div>
            <div class="system-status">
                <div class="status-indicator">
                    <span class="pulse-dot"></span>
                    <span>LIVE</span>
                </div>
                <span id="missionClock" class="mission-clock">--:--:-- UTC</span>
            </div>
        </div>

        <!-- Left Command Panel - Redesigned -->
        <div class="hud-left pointer-events-auto">
            
            <!-- Mission Zone Card -->
            <div class="neo-panel mission-zone-panel">
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üìç</span>
                        <span class="header-title">Mission Zone</span>
                    </div>
                    <button id="btnGenerateReport" class="neo-btn-sm">
                        <span>üìÑ</span> Report
                    </button>
                </div>
                <div class="neo-panel-body">
                    <div class="zone-selector-wrapper">
                        <select id="villageSelector" class="neo-select">
                            <option value="wayanad_meppadi">Meppadi, Kerala</option>
                            <option value="darbhanga">Darbhanga, Bihar</option>
                            <option value="dhemaji">Dhemaji, Assam</option>
                        </select>
                        <div class="select-glow"></div>
                    </div>
                    <div id="villageInfo" class="zone-meta">
                        <span class="zone-stat">--</span>
                    </div>
                </div>
            </div>

            <!-- Model Intelligence Card - Enhanced -->
            <div class="neo-panel intel-panel">
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üß†</span>
                        <span class="header-title">Model Intelligence</span>
                    </div>
                    <span class="neo-badge ai-badge">AI Core</span>
                </div>
                <div class="neo-panel-body">
                    <div class="intel-grid">
                        <div class="intel-item">
                            <div class="intel-label">Terrain Analysis</div>
                            <div class="intel-value" id="intelStability">--</div>
                            <div class="intel-bar">
                                <div class="intel-bar-fill" id="intelStabilityBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="intel-item">
                            <div class="intel-label">Hydro Focus</div>
                            <div class="intel-value" id="intelFocus">--</div>
                            <div class="intel-bar">
                                <div class="intel-bar-fill hydro" id="intelFocusBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="intel-item full-width">
                            <div class="intel-label">Impact Prediction</div>
                            <div class="intel-value large" id="intelImpact">--</div>
                        </div>
                    </div>
                    <div class="model-footer">
                        <div class="accuracy-ring">
                            <svg viewBox="0 0 36 36" class="circular-chart">
                                <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                                <path class="circle" id="accuracyCircle" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                            </svg>
                            <span class="accuracy-text" id="modelAccuracy">--%</span>
                        </div>
                        <div class="model-meta">
                            <span class="meta-label">Model Confidence</span>
                            <span class="meta-value" id="modelStatus">Initializing...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Risk Metrics Card - Enhanced -->
            <div class="neo-panel metrics-panel">
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üìä</span>
                        <span class="header-title">Risk Metrics</span>
                    </div>
                    <span class="neo-badge" id="riskBadge">STABLE</span>
                </div>
                <div class="neo-panel-body">
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-icon">‚õ∞Ô∏è</div>
                            <div class="metric-data">
                                <span class="metric-value" id="valElev">--</span>
                                <span class="metric-label">Elevation</span>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">üìê</div>
                            <div class="metric-data">
                                <span class="metric-value" id="valSlope">--</span>
                                <span class="metric-label">Slope</span>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">üíß</div>
                            <div class="metric-data">
                                <span class="metric-value" id="valRunoff">--</span>
                                <span class="metric-label">Hydro Index</span>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">‚ö†Ô∏è</div>
                            <div class="metric-data">
                                <span class="metric-value" id="valArea">--</span>
                                <span class="metric-label">Risk Area</span>
                            </div>
                        </div>
                        <div class="metric-card highlight">
                            <div class="metric-icon">üå±</div>
                            <div class="metric-data">
                                <span class="metric-value" id="valSoil">--</span>
                                <span class="metric-label">Soil Satur.</span>
                            </div>
                        </div>
                        <div class="metric-card highlight danger">
                            <div class="metric-icon">üë•</div>
                            <div class="metric-data">
                                <span class="metric-value" id="totalPopRisk">--</span>
                                <span class="metric-label">Pop. at Risk</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Yearly Forecast Card -->
            <div class="neo-panel forecast-panel">
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üìà</span>
                        <span class="header-title">Yearly Forecast</span>
                    </div>
                    <span class="neo-badge grounded">Grounded AI</span>
                </div>
                <div class="neo-panel-body">
                    <div class="chart-container">
                        <canvas id="yearlyChart"></canvas>
                    </div>
                    <div class="forecast-footer">
                        <div class="forecast-stat">
                            <span class="stat-label">Weekly</span>
                            <span class="stat-value" id="valWeekly">--</span>
                        </div>
                        <div class="forecast-stat">
                            <span class="stat-label">Flood Prob.</span>
                            <span class="stat-value" id="valMonthly">--</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Live Weather Card -->
            <div class="neo-panel weather-panel">
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üå°Ô∏è</span>
                        <span class="header-title">Live Conditions</span>
                    </div>
                    <span class="weather-time" id="weatherTime">--:--</span>
                </div>
                <div class="neo-panel-body">
                    <div class="weather-main">
                        <div class="weather-icon-wrap">
                            <span id="weatherIcon" class="weather-icon">‚òÄÔ∏è</span>
                        </div>
                        <div class="weather-temp-wrap">
                            <span id="weatherTemp" class="weather-temp">--¬∞C</span>
                            <span id="weatherDesc" class="weather-desc">Loading...</span>
                        </div>
                    </div>
                    <div class="weather-details">
                        <div class="weather-detail">
                            <span class="detail-icon">üí®</span>
                            <span class="detail-value"><span id="weatherWind">--</span> km/h</span>
                        </div>
                        <div class="weather-detail">
                            <span class="detail-icon">üíß</span>
                            <span class="detail-value"><span id="weatherHum">--</span>%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Short-term Forecast Card -->
            <div class="neo-panel shortterm-panel">
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üåßÔ∏è</span>
                        <span class="header-title">7-Day Rainfall</span>
                    </div>
                </div>
                <div class="neo-panel-body">
                    <div class="chart-container small">
                        <canvas id="shortTermChart"></canvas>
                    </div>
                    <div id="forecastSummary" class="forecast-summary">
                        Loading forecast...
                    </div>
                </div>
            </div>

        </div>

        <!-- Right Command Panel -->
        <div class="hud-right pointer-events-auto">

            <!-- Deep Scan Inspector -->
            <div id="cellInspector" class="neo-panel scan-panel" style="display:none;">
                <div class="scanning-line"></div>
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üîç</span>
                        <span class="header-title">Tactical Scan</span>
                    </div>
                    <button onclick="closeInspector()" class="close-btn">‚úï</button>
                </div>
                <div id="inspectTerrainType" class="scan-terrain">--</div>
                <div class="neo-panel-body">
                    <div class="scan-grid">
                        <div class="scan-item">
                            <span class="scan-label">Elevation</span>
                            <span class="scan-value" id="inspectElev">--</span>
                        </div>
                        <div class="scan-item">
                            <span class="scan-label">Water Depth</span>
                            <span class="scan-value" id="inspectDepth">--</span>
                        </div>
                        <div class="scan-item highlight">
                            <span class="scan-label">Pop. at Risk</span>
                            <span class="scan-value danger" id="inspectPopAtRisk">--</span>
                        </div>
                        <div class="scan-item">
                            <span class="scan-label">Density</span>
                            <span class="scan-value" id="inspectDensity">--</span>
                        </div>
                    </div>
                    <div class="risk-assessment">
                        <span class="risk-label">Risk Assessment</span>
                        <span class="risk-value" id="inspectRisk">SCANNING...</span>
                        <div class="risk-bar">
                            <div class="risk-bar-fill risk-marker"></div>
                        </div>
                    </div>
                    <div id="inspectRiskFactors" class="risk-factors"></div>
                    <div id="inspectEvacuation" class="evac-alert" style="display:none;">--</div>
                </div>
            </div>

            <!-- Layer Controls - Redesigned -->
            <div class="neo-panel layers-panel">
                <div class="neo-panel-header">
                    <div class="header-left">
                        <span class="header-icon">üì°</span>
                        <span class="header-title">Layer Controls</span>
                    </div>
                </div>
                <div class="neo-panel-body">
                    <div class="layer-buttons">
                        <button id="btnLayerPop" class="neo-layer-btn" onclick="setupLayerToggle('btnLayerPop', 'population-layer')">
                            <span class="layer-icon">üë•</span>
                            <span class="layer-text">Population Density</span>
                            <span class="layer-toggle"></span>
                        </button>
                        <button id="btnFindRescue" class="neo-layer-btn rescue" onclick="toggleRescueMode()">
                            <span class="layer-icon">üõü</span>
                            <span class="layer-text">Find Rescue Path</span>
                            <span class="layer-toggle"></span>
                        </button>
                        <button id="btnLayerRisk" class="neo-layer-btn active" onclick="setupLayerToggle('btnLayerRisk', 'flood-risk-layer')">
                            <span class="layer-icon">üåä</span>
                            <span class="layer-text">Flood Risk Grid</span>
                            <span class="layer-toggle"></span>
                        </button>
                    </div>
                </div>
            </div>

        </div>

        <!-- Player Bar with Rainfall Input -->
        <div class="hud-bottom pointer-events-auto">
            <div class="player-bar">
                <button class="play-btn-circle" id="masterPlayBtn">‚ñ∂</button>

                <!-- Rainfall Input -->
                <div class="rainfall-control">
                    <div class="control-label">RAINFALL INPUT</div>
                    <div class="control-wrapper">
                        <input type="range" id="rainfallSlider" min="0" max="300" value="50">
                        <span id="rainfallValue">50 mm</span>
                    </div>
                </div>

                <div class="simulation-meta">
                    <div class="meta-header">
                        <span class="meta-label">FLOOD SIMULATION</span>
                        <span id="timeDisplay">+0h</span>
                    </div>
                    <div class="timeline-track">
                        <div class="timeline-fill" id="timelineFill"></div>
                    </div>
                    <div class="timeline-ticks">
                        <div class="tick active" data-t="0">START</div>
                        <div class="tick" data-t="1">+4h</div>
                        <div class="tick" data-t="2">+8h</div>
                        <div class="tick" data-t="3">+12h</div>
                        <div class="tick" data-t="4">+16h</div>
                        <div class="tick" data-t="5">+20h</div>
                        <div class="tick" data-t="6">24h</div>
                    </div>
                </div>
            </div>

            <!-- Simulation Report Panel (Hidden by default) -->
            <div id="simulationReport" class="neo-panel" style="display:none; margin-top:10px; padding:15px;">
                <div class="neo-panel-header">
                    <span class="header-title">üìä Simulation Report</span>
                    <button id="closeReport" class="close-btn">‚úï</button>
                </div>
                <div id="reportContent" class="report-content"></div>
            </div>
        </div>

    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-logo">üåä</div>
            <div class="loading-brand">Jal Drishti</div>
            <div class="loading-text">Initializing Mission Control...</div>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <script src="js/enhanced.js?v=3.0"></script>
</body>

</html>
